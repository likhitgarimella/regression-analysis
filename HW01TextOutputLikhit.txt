> # Likhit Garimella> # Regression Analysis HW-1> > # libraries> #install.packages("faraway")> #install.packages("olsrr")> #install.packages("psych")> #install.packages("readr")> library(faraway)> library(olsrr)> library(psych)> library(readr)> > # (a) fitting the linear regression model> # import the dataset> myData = read.csv("/Users/likhitgarimella/Desktop/SummerSemester/prob2_18.csv")> myData=myData[order(myData$amount),]> # print the dataset> myData              firm amount ret_impress14    Calvin Klein    5.0        12.017          Shasta    5.7        10.021  Kibbles N Bits    6.1         4.418        Meow Mix    7.6        12.319     Oscar Meyer    9.2        23.43          Strohs    19.3        11.79        Diet Cola   20.4        21.44  Federal Express   22.9        21.98              MCI   26.9        50.716        Polaroid   26.9        38.011           Levis   27.0        40.820           Crest   32.4        71.16        Coca-Cola   40.1        78.612        Bud Lite   45.6        10.415         Wendys    49.7        29.21      Miller Lite   50.1        32.12            Pepsi   74.1        99.65      Burger King   82.4        60.813        ATT Bell  154.9        88.910            Ford  166.2        40.17        McDonalds  185.9        92.4> # extract the columns from dataset to model> lmod = lm(ret_impress ~ amount, data=myData)> > # save output in a pdf file> pdf(file="/Users/likhitgarimella/Desktop/SummerSemester/HW01plotsLikhit.pdf")> > # (b) graph b/w amount and retained impressions> plot(ret_impress ~ amount, data = myData, xlab = "Amount Spent", ylab = "Retained Impressions", main = "Likhit Garimella lg836 | Scatterplot Linear Regression Line")> # line> abline(lmod)> # graph summary> summary(lmod)Call:lm(formula = ret_impress ~ amount, data = myData)Residuals:    Min      1Q  Median      3Q     Max -42.422 -12.623  -8.171   8.832  50.526 Coefficients:            Estimate Std. Error t value Pr(>|t|)   (Intercept) 22.16269    7.08948   3.126  0.00556 **amount       0.36317    0.09712   3.739  0.00139 **---Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1Residual standard error: 23.5 on 19 degrees of freedomMultiple R-squared:  0.424,	Adjusted R-squared:  0.3936 F-statistic: 13.98 on 1 and 19 DF,  p-value: 0.001389> anova(lmod)Analysis of Variance TableResponse: ret_impress          Df  Sum Sq Mean Sq F value   Pr(>F)   amount     1  7723.3  7723.3  13.983 0.001389 **Residuals 19 10494.1   552.3                    ---Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1> > # (c) get confidence band> # plot old graph> plot(ret_impress ~ amount, data = myData, xlab = "Amount Spent", ylab = "Retained Impressions")> confband = predict(lmod,interval="confidence",level=0.95)> head(confband)        fit       lwr      upr14 23.97856  9.822755 38.1343717 24.23279 10.169329 38.2962421 24.37806 10.366995 38.3891218 24.92282 11.105753 38.7398819 25.50389 11.889280 39.118513  29.17195 16.714663 41.62924> confband        fit       lwr       upr14 23.97856  9.822755  38.1343717 24.23279 10.169329  38.2962421 24.37806 10.366995  38.3891218 24.92282 11.105753  38.7398819 25.50389 11.889280  39.118513  29.17195 16.714663  41.629249  29.57144 17.226126  41.916764  30.47938 18.377023  42.581748  31.93208 20.183136  43.6810216 31.93208 20.183136  43.6810211 31.96839 20.227703  43.7090820 33.92953 22.589069  45.270006  36.72597 25.789707  47.6622412 38.72343 27.945201  49.5016615 40.21244 29.477527  50.947361  40.35771 29.623567  51.091862  49.07389 37.308363  60.839425  52.08824 39.537115  64.6393613 78.41836 54.618119 102.2186010 82.52222 56.651104 108.393347  89.67675 60.115328 119.23818> > # plot with confidence bands> lines(myData[,2],confband[,2],col="red",lty=2)> lines(myData[,2],confband[,3],col="red",lty=2)> > # (c) get prediction band> predband = predict(lmod,interval="prediction",level=0.95)Warning message:In predict.lm(lmod, interval = "prediction", level = 0.95) :  predictions on current data refer to _future_ responses> head(predband)        fit       lwr      upr14 23.97856 -27.20707 75.1642017 24.23279 -26.92739 75.3929621 24.37806 -26.76774 75.5238518 24.92282 -26.17017 76.0158119 25.50389 -25.53472 76.542513  29.17195 -21.57020 79.91411> predband        fit        lwr       upr14 23.97856 -27.207071  75.1642017 24.23279 -26.927385  75.3929621 24.37806 -26.767737  75.5238518 24.92282 -26.170173  76.0158119 25.50389 -25.534718  76.542513  29.17195 -21.570203  79.914119  29.57144 -21.143338  80.286234  30.47938 -20.176808  81.135578  31.93208 -18.640841  82.5049916 31.93208 -18.640841  82.5049911 31.96839 -18.602607  82.5393920 33.92953 -16.550051  84.409126  36.72597 -13.664345  87.1162912 38.72343 -11.632825  89.0796915 40.21244 -10.134558  90.559451  40.35771  -9.989125  90.704552  49.07389  -1.502881  99.650675  52.08824   1.322964 102.8535113 78.41836  23.773745 133.0629710 82.52222  26.944377 138.100077  89.67675  32.288077 147.06543> > # plot with prediction bands> lines(myData[,2],predband[,2],col="green",lty=2)> lines(myData[,2],predband[,3],col="green",lty=2)> > newdf = data.frame(amount=seq(5,185.9,by=0.5)) > head(newdf)  amount1    5.02    5.53    6.04    6.55    7.06    7.5> plot(ret_impress ~ amount, data = myData, xlab = "Amount Spent", ylab = "Retained Impressions")> abline(lmod)> > confband = predict(lmod,newdata = newdf,interval="confidence",level=0.95)> newdfc = cbind(newdf,confband)> > # plot with confidence bands> lines(newdfc[,1],newdfc[,2],col="red",lty=2)> lines(newdfc[,1],newdfc[,3],col="red",lty=2)> lines(newdfc[,1],newdfc[,4],col="red",lty=2)> > predband = predict(lmod,newdata = newdf,interval="predict",level=0.95)> newdfp = cbind(newdf,predband)> > # plot with prediction bands> lines(newdfp[,1],newdfp[,2],col="green",lty=2)> lines(newdfp[,1],newdfp[,3],col="green",lty=2)> lines(newdfp[,1],newdfp[,4],col="green",lty=2)> > # confidence and prediction intervals> confint(lmod)                2.5 %     97.5 %(Intercept) 7.324244 37.0011425amount      0.159899  0.5664492> predict(lmod,newdata=data.frame(amount=50.4),interval="confidence",level=0.95)        fit      lwr      upr1 40.46667 29.73269 51.20064> predict(lmod,newdata=data.frame(amount=50.4),interval="prediction",level=0.95)       fit       lwr      upr1 40.46667 -9.880136 90.81347> # summary> summary(predict(lmod))   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.   23.98   29.17   31.97   40.47   40.36   89.68 > summary(residuals(lmod))   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. -42.422 -12.623  -8.171   0.000   8.832  50.526 > > # residuals> ei = residuals(lmod)  > SSE=sum(ei^2)   > head(cbind(myData,lmod$fitted.values,ei))             firm amount ret_impress lmod$fitted.values         ei14   Calvin Klein    5.0        12.0           23.97856 -11.97856417         Shasta    5.7        10.0           24.23279 -14.23278621 Kibbles N Bits    6.1         4.4           24.37806 -19.97805518       Meow Mix    7.6        12.3           24.92282 -12.62281619    Oscar Meyer    9.2        23.4           25.50389  -2.1038953         Strohs    19.3        11.7           29.17195 -17.471953> summary(ei)   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. -42.422 -12.623  -8.171   0.000   8.832  50.526 > describe(ei)   vars  n mean    sd median trimmed  mad    min   max range skew kurtosis seX1    1 21    0 22.91  -8.17   -1.27 17.5 -42.42 50.53 92.95 0.56    -0.25  5> (lmod_olsrr = ols_regress(ret_impress ~ amount, data=myData))                         Model Summary                          ---------------------------------------------------------------R                       0.651       RMSE                23.502 R-Squared               0.424       Coef. Var           58.076 Adj. R-Squared          0.394       MSE                552.322 Pred R-Squared          0.271       MAE                 17.634 --------------------------------------------------------------- RMSE: Root Mean Square Error  MSE: Mean Square Error  MAE: Mean Absolute Error                                 ANOVA                                 ---------------------------------------------------------------------                 Sum of                                                              Squares        DF    Mean Square      F         Sig. ---------------------------------------------------------------------Regression     7723.278         1       7723.278    13.983    0.0014 Residual      10494.109        19        552.322                     Total         18217.387        20                                    ---------------------------------------------------------------------                                 Parameter Estimates                                   --------------------------------------------------------------------------------------      model      Beta    Std. Error    Std. Beta      t       Sig     lower     upper --------------------------------------------------------------------------------------(Intercept)    22.163         7.089                 3.126    0.006    7.324    37.001      amount     0.363         0.097        0.651    3.739    0.001    0.160     0.566 --------------------------------------------------------------------------------------> ols_plot_resid_hist(lmod)> dev.off()null device           1 > 